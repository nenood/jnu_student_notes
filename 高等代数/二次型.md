# 二次型

## 矩阵表示

$$
\begin{align}
&二次型可以写成 \\
&f(x_1, x_2, \dots, x_n) = \mathbf{X^T A X} \\ \\
&\mathbf{A} = 
\begin{pmatrix}
a_{11} & a_{12} & \dots & a_{1n} \\
a_{21} & a_{22} & \dots & a_{2n} \\
\vdots & \vdots &       & \vdots \\
a_{n1} & a_{n2} & \dots & a_{nn} \\
\end{pmatrix}
,&a_{ij} = a_{ji}(i,j=1,2,\dots,n) \\ \\
&线性替换可以写成 \\
&\mathbf{X = CY} \\
&其中~\mathbf{C}~为替换中的系数矩阵
\end{align}
$$

-   对于矩阵 $\mathbf{A, B}$ 若存在 $\mathbf{C}$ 使得 $\mathbf{B = C^T A C}$
    则称矩阵 $\mathbf{A, B}$ 为 **合同** 的
    由矩阵 $\mathbf{A}$ 到 $\mathbf{B}$ 的变换称为 **合同变换**
-   合同关系满足 **自反性、对称性、传递性**

## 标准形

#### 配方法化标准形

1.   若有平方项，则从 $x_1$ 到 $x_n$，依次将含有该变量的项合并，然后配方

2.   若没有平方项，则先作平方差替换，构造出平方项

**例：**
$$
f(x_1, x_2, x_3) = 2x_1x_2 + 2x_1x_3 - 6x_2x_3
$$
**解：**
$$
\begin{align}

&没有平方项，则先作平方差替换 \\
&\begin{cases}
x_1 = y_1+y_2 \\
x_2 = y_1-y_2 \\
x_3 = y_3
\end{cases}
~~~，~得到 \\ \\
 & f(x_1, x_2, x_3) \\
=& 2y_1^2 - 2y_2^2 -4y_1y_3+8y_2y_3 
（此时有平方项，对~2y_1^2-4y_1y_3~配方）\\
=& 2(y_1- y_3)^2 - 2y_2^2 + 8y_2y_3 - 2y_3^2
（此时有平方项，对~- 2y_2^2 + 8y_2y_3~配方）\\
=& 2(y_1- y_3)^2 - 2(y_2^2 - 4y_2y_3) - 2y_3^2 \\
=& 2(y_1- y_3)^2 - 2(y_2 - 2y_3)^2 + 6y_3^2 \\ \\
&接下来令 \\
&\begin{cases}
z_1 = y_1- y_3 \\
z_2 = y_2 - 2y_3 \\
z_3 = y_3
\end{cases} \\
&即作非退化线性替换 \\
&\begin{cases}
y_1 = z_1 + z_3 \\
y_2 = z_2 + 2z_3 \\
y_3 = z_3
\end{cases} \\ \\
&得到 \\
&f(x_1, x_2, x_3)=2z_1^2-2z_2^2+6z_3^2 \\ \\

&总线性替换为 \\
&
\mathbf{C} = 
\begin{pmatrix}
1 & 1 & 0 \\
1 & -1 & 0 \\
0 & 0 & 1 \\
\end{pmatrix}
\begin{pmatrix}
1 & 0 & 1 \\
0 & 1 & 2 \\
0 & 0 & 1 \\
\end{pmatrix}
=
\begin{pmatrix}
1 & 1 & 3 \\
1 & -1 & -1 \\
0 & 0 & 1 \\
\end{pmatrix}

\end{align}
$$


#### 合同变换法化标准形

1.   在二次型的矩阵下放置一个单位矩阵，

2.   将上方的二次型的矩阵化为单位矩阵，对整个矩阵同时进行相同的行列变换

**解：**
$$
\begin{pmatrix}

0 & 1 & 1 \\
1 & 0 & -3 \\
1 & -3 & 0 \\
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1 \\

\end{pmatrix}
\xrightarrow[c_1 + c_2]{r_1 + r_2}
\begin{pmatrix}

2 & 1 & -2 \\
1 & 0 & -3 \\
-2 & -3 & 0 \\
1 & 0 & 0 \\
1 & 1 & 0 \\
0 & 0 & 1 \\

\end{pmatrix}
\xrightarrow[c_3+c_1]{r_3+r_1}
\begin{pmatrix}

2 & 1 & 0 \\
1 & 0 & -2 \\
0 & -2 & -2 \\
1 & 0 & 1 \\
1 & 1 & 1 \\
0 & 0 & 1 \\

\end{pmatrix}
$$

$$
\xrightarrow[c_2-c_1/2]{r_2-r_1/2}
\begin{pmatrix}

2 & 0 & 0 \\
0 & -1/2 & -2 \\
0 & -2 & -2 \\
1 & -1/2 & 1 \\
1 & 1/2 & 1 \\
0 & 0 & 1 \\

\end{pmatrix}
\xrightarrow[c_3-4\times c_1]{r_3-4\times r_1}
\begin{pmatrix}

2 & 0 & 0 \\
0 & -1/2 & 0 \\
0 & 0 & 6 \\
1 & -1/2 & 3 \\
1 & 1/2 & -1 \\
0 & 0 & 1 \\

\end{pmatrix}
$$

$$
\begin{align}
&所以得到的标准形为\\
&f(x_1, x_2, x_3)=2z_1^2-\frac{1}{2}z^2+6z_3^2 \\ \\

&线性替换为 \\
&
\mathbf{C} = 
\begin{pmatrix}
1 & -1/2 & 3 \\
1 & 1/2 & -1 \\
0 & 0 & 1 \\
\end{pmatrix}
\end{align}
$$

#### 正交变换法化标准形

详见“欧几里得空间”一章中“实对称矩阵的标准形”

## 唯一性

-   对于复二次型或者说复对称矩阵，都可以化为规范形，
    即复对称矩阵必合同于一个对角阵，其对角元素部分为 $1$，部分为 $0$

    -   两个复对称矩阵合同的 **充要条件** 是二者的秩相等

-   对于实二次型或者说实对称矩阵，都可以化为规范性
    即实对称矩阵必合同于一个对角阵，其对角元素部分为 $1$，部分为 $-1$

    -   实二次型的规范性中，
        正平方项的个数称为 **正惯性指数**，

        负平方项的个数称为 **负惯性指数**，
        它们的差称为 **符号差**

-   复对称矩阵的规范形中，
    矩阵对角形上的 $1$ 的个数是唯一确定的，个数等于原复对称矩阵的秩

-   实对称矩阵的规范形中，
    矩阵的正负惯性指数是唯一确定的，二者的和等于原实对称矩阵的秩

## 正定二次型

### 定义

-   对于实二次型 $f(x_1, x_2, \dots, x_n)$，
    如果任意一组不全为 $0$ 的实数 $c_1,c_2, \dots, c_n$ 带入二次型，
    都有 $f(c_1, c_2, \dots,c_n) > 0$ ，
    则该二次型称为 **正定二次型**，称它对应的实对称矩阵是 **正定矩阵**
    -   非退化线性替换保持正定性不变

-   $$
    H_i=
    \begin{vmatrix}
    a_{11} & a_{12} & \dots & a_{1i} \\
    a_{21} & a_{22} & \dots & a_{2i} \\
    \vdots & \vdots &       & \vdots \\
    a_{i1} & a_{i2} & \dots & a_{ii} \\
    \end{vmatrix},&i=1,2,\dots,n
    $$

    该子式称为 **顺序主子式**

-   对于实二次型 $f(x_1, x_2, \dots, x_n)$，
    如果任意一组不全为 $0$ 的实数 $c_1,c_2, \dots, c_n$ 带入二次型，
    都有 $f(c_1, c_2, \dots,c_n) < 0$ ，则该二次型称为 **负定的**
    都有 $f(c_1, c_2, \dots,c_n) \ge 0$ ，则该二次型称为 **半正定的**
    都有 $f(c_1, c_2, \dots,c_n) \le 0$ ，则该二次型称为 **半负定的**
    如果它既不半正定也不半负定，则称为 **不定的**

### 定理

-   $n$ 元的实二次型是正定的与下面四个条件均等价（即 **充要条件**）：

    1.   它的正惯性指数等于 $n$
    2.   它的矩阵合同于单位矩阵
    3.   它的矩阵的顺序主子式全大于零
    4.   $-f(c_1, c_2, \dots,c_n)$  是负定的

    **推论：**正定矩阵的行列式大于零

-   对于实二次型，以下条件等价：
    1.   $f(x_1, x_2, \dots, x_n)$ 是半正定的
    2.   它的正惯性指数与秩相等
    3.   存在实**可逆**矩阵（即非退化的） $\mathbf{C}$ 使得 $\mathbf{C^T AC}$ 为对角形，
         对角线上元素均大于等于零
    4.   有实矩阵 $\mathbf{C}$ 使得 $\mathbf{A = C^T C}$
    5.   其矩阵的所有 **主子式** 均大于等于零（**不是顺序主子式！**）
